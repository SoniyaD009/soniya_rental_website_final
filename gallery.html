<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Soniya Rental Dresses â€” Gallery</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>
<body>
  <header>
    <div class="header-container">
      <h1>SONIYA RENTAL DRESSES</h1>
      <nav>
        <a href="index.html" title="Home"><i class="bi bi-house-fill"></i></a>
        <a href="#categories" title="Categories"><i class="bi bi-grid-fill"></i></a>
        <a href="#contact" title="Contact"><i class="bi bi-telephone-fill"></i></a>
      </nav>
    </div>
  </header>

  <main style="padding:1em;">
    <h2 class="section-title">Catalog Gallery</h2>

    <!-- Responsive CSS-grid container -->
    <div id="gallery-grid" class="gallery-grid" aria-live="polite"></div>
  </main>

  <footer>
    <div class="footer-content">
      <a href="https://www.instagram.com/soniyarentaldresses?igsh=Y21yazJveDZlMmg5" target="_blank">
        <i class="bi bi-instagram"></i> <span>soniyarentaldresses</span>
      </a>
      <a href="mailto:soniyarentaldresses@gmail.com">
        <i class="bi bi-envelope-fill"></i> <span>soniyarentaldresses9@gmail.com</span>
      </a>
      <a href="tel:+918329181166">
        <i class="bi bi-telephone-fill"></i> <span>+918329181166</span>
      </a>
    </div>
  </footer>

  <script>
  (function () {
    const params = new URLSearchParams(window.location.search);
    const category = params.get('category') || 'western';
    const subcategory = params.get('subcategory') || 'kg';
    const grid = document.getElementById('gallery-grid');

    // ---- Helper: try to load an optional manifest (index.json) that lists filenames ----
    async function loadManifest(path) {
      try {
        const res = await fetch(path, {cache: 'no-cache'});
        if (!res.ok) throw new Error('No manifest');
        const data = await res.json();
        if (Array.isArray(data)) return data.filter(s => typeof s === 'string' && s.toLowerCase().endsWith('.jpg'));
      } catch (e) {
        return null;
      }
    }

    // ---- Build DOM element for each tile (keeps equal size via CSS) ----
    function createGalleryItem(src, alt) {
      const item = document.createElement('div');
      item.className = 'gallery-item';
      const img = document.createElement('img');
      img.src = src;
      img.alt = alt || '';
      img.loading = 'lazy';
      img.decoding = 'async';
      img.addEventListener('error', () => { item.style.display = 'none'; });
      // click opens full-size image in new tab (simple lightbox fallback)
      item.addEventListener('click', () => window.open(src, '_blank'));
      item.appendChild(img);
      return item;
    }

    // ---- Main loader ----
    async function loadImages() {
      const basePath = `catalogs/${category}/${subcategory}/`;

      // 1) Prefer a manifest if present: catalogs/<cat>/<sub>/index.json
      const manifest = await loadManifest(basePath + 'index.json');
      if (manifest && manifest.length) {
        manifest.forEach(fname => grid.appendChild(createGalleryItem(basePath + fname, fname)));
        return;
      }

      // 2) Fallback: probe sequential numeric filenames: 1.jpg, 2.jpg, ...
      let i = 1;
      const maxAttempts = 300;                // hard cap
      let consecutiveMisses = 0;
      const allowedConsecutiveMisses = 6;    // stops after N missing in a row
      while (i <= maxAttempts && consecutiveMisses < allowedConsecutiveMisses) {
        const filename = i + '.jpg';
        const src = basePath + filename;

        try {
          // First try a HEAD request to check existence (works when server allows)
          const resp = await fetch(src, { method: 'HEAD' });
          if (resp.ok) {
            grid.appendChild(createGalleryItem(src, filename));
            consecutiveMisses = 0;
          } else {
            consecutiveMisses++;
          }
        } catch (e) {
          // If HEAD is blocked (CORS or file server), fall back to Image() load check
          await new Promise(resolve => {
            const imgTest = new Image();
            imgTest.src = src;
            imgTest.onload = () => { grid.appendChild(createGalleryItem(src, filename)); consecutiveMisses = 0; resolve(); };
            imgTest.onerror = () => { consecutiveMisses++; resolve(); };
          });
        }
        i++;
      }

      // If none found, show friendly guidance
      if (!grid.children.length) {
        const msg = document.createElement('div');
        msg.className = 'no-images';
        msg.textContent = 'No .jpg catalog images found in ' + basePath + '. Place .jpg files there (1.jpg, 2.jpg...) or add index.json.';
        grid.appendChild(msg);
      }
    }

    loadImages();
  })();
  </script>
</body>
</html>







